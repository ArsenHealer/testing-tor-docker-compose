version: '3.8'

services:
  # Управляющие серверы
  da1:
    build: .
    volumes:
      - ./da1/torrc:/etc/tor/torrc
    environment:
      - NICK=dauvfnvkeo
      - IP_ADDR=10.5.11.139
      - ROLE=da
    networks:
      tor-network:
        ipv4_address: 10.5.11.139

  da2:
    build: .
    volumes:
      - ./da2/torrc:/etc/tor/torrc
    environment:
      - NICK=daxunpfymo
      - IP_ADDR=10.5.99.44
      - ROLE=da
    networks:
      tor-network:
        ipv4_address: 10.5.99.44

  da3:
    build: .
    volumes:
      - ./da3/torrc:/etc/tor/torrc
    environment:
      - NICK=dahgndngrb
      - IP_ADDR=10.5.179.14
      - ROLE=da
    networks:
      tor-network:
        ipv4_address: 10.5.179.14

  # Реле
  relay1:
    build: .
    volumes:
      - ./relay1/torrc:/etc/tor/torrc
    environment:
      - NICK=relaynzsilcfk
      - IP_ADDR=10.5.188.28
      - ROLE=relay
    networks:
      tor-network:
        ipv4_address: 10.5.188.28

  relay2:
    build: .
    volumes:
      - ./relay2/torrc:/etc/tor/torrc
    environment:
      - NICK=relayhctniqea
      - IP_ADDR=10.5.88.31
      - ROLE=relay
    networks:
      tor-network:
        ipv4_address: 10.5.88.31

  relay3:
    build: .
    volumes:
      - ./relay3/torrc:/etc/tor/torrc
    environment:
      - NICK=relayphruftoo
      - IP_ADDR=10.5.137.197
      - ROLE=relay
    networks:
      tor-network:
        ipv4_address: 10.5.137.197

  relay4:
    build: .
    volumes:
      - ./relay4/torrc:/etc/tor/torrc
    environment:
      - NICK=relaypsxaafiq
      - IP_ADDR=10.5.229.1
      - ROLE=relay
    networks:
      tor-network:
        ipv4_address: 10.5.229.1

  relay5:
    build: .
    volumes:
      - ./relay5/torrc:/etc/tor/torrc
    environment:
      - NICK=relayageofxuu
      - IP_ADDR=10.5.104.32
      - ROLE=relay
    networks:
      tor-network:
        ipv4_address: 10.5.104.32

  # Выходные узлы
  exit1:
    build: .
    volumes:
      - ./exit1/torrc:/etc/tor/torrc
    environment:
      - NICK=exitvbmpegsv
      - IP_ADDR=10.5.56.142
      - ROLE=exit
    networks:
      tor-network:
        ipv4_address: 10.5.56.142

  exit2:
    build: .
    volumes:
      - ./exit2/torrc:/etc/tor/torrc
    environment:
      - NICK=exitqmrbravr
      - IP_ADDR=10.5.242.11
      - ROLE=exit
    networks:
      tor-network:
        ipv4_address: 10.5.242.11

  exit3:
    build: .
    volumes:
      - ./exit3/torrc:/etc/tor/torrc
    environment:
      - NICK=exitwhitmyoo
      - IP_ADDR=10.5.82.75
      - ROLE=exit
    networks:
      tor-network:
        ipv4_address: 10.5.82.75

  # Клиент
  client:
    build: .
    volumes:
      - ./client/torrc:/etc/tor/torrc
    environment:
      - NICK=clientpdca
      - IP_ADDR=10.5.140.177
      - ROLE=client
    networks:
      tor-network:
        ipv4_address: 10.5.140.177

  # сервис onion
  hs:
    build: .
    volumes:
      - ./hs/torrc:/etc/tor/torrc
    environment:
      - NICK=hsservice
      - IP_ADDR=10.5.108.221
      - ROLE=hs
    networks:
      tor-network:
        ipv4_address: 10.5.108.221

networks:
  tor-network:
    driver: bridge
    ipam:
      config:
        - subnet: 10.5.0.0/16